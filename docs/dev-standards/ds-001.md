# Development Standard: DS-001 Explicit Return Types

Standard ID: DS-001
Category: Typing
Status: Draft
Owner: Engineering
Last Updated: 2025-09-02
Version: 1.0.0

## 1. Summary

All exported functions, methods, and public route handlers must declare an explicit return type to prevent implicit any or unexpected widening, improving readability, API stability, and refactor safety.

## 2. Rationale

- Prevents accidental return type changes during refactors.
- Enhances IDE discoverability and consumer integration confidence.
- Supports stable public contracts (ties R-024, R-098, R-107).
- Reduces risk of silently returning `any` (related to DS-002).

## 3. Normative Requirement Statement

> All exported symbols (functions, class methods, SvelteKit route handlers, modules) MUST declare an explicit return type; implicit inference is prohibited for exported APIs.

## 4. Scope

- In-Scope: `export`ed functions, route handlers (`+server.ts`), public class/static methods.
- Out-of-Scope: Local (non-exported) helpers, test-only utilities, generated code.

## 5. Definitions

- Exported API: Any symbol re-exported or exposed outside its defining module/package.

## 6. Examples

### 6.1 Compliant

```ts
export function buildPrompt(ctx: PromptContext): PromptPayload { /* ... */ }
```

### 6.2 Non-Compliant

```ts
export function buildPrompt(ctx) { /* implicit any & return inference */ }
```

### 6.3 Edge Cases

- Re-exported constants must have explicit type if object literal: `export const retrieverConfig: RetrieverConfig = { ... }`.

## 7. Implementation Guidance

- Use named interfaces / type aliases over inline complex return types for clarity.
- For async functions: `Promise<Result<T, E>>` rather than implicit `Promise<any>`.

## 8. Tooling & Enforcement

- ESLint: `@typescript-eslint/explicit-function-return-type` (configured for exported only).
- CI fails on violations.

## 9. Metrics & Reporting

- Lint violation count (target 0). Included in CI logs.

## 10. Related Standards & Requirements

- DS-002 (no any), DS-014 (internal inference allowed), R-107 (strict TS config).

## 11. Exception Process

- Temporary exception allowed for rapid spike prototypes (<7 days) with ticket + auto reminder.

## 12. Risks if Violated

- Silent API drift, unintentional widening to `any`.

## 13. Security / Privacy Considerations

- Explicit types reduce accidental leakage (e.g., including restricted fields inadvertently).

## 14. Performance Considerations

- Negligible compile overhead.

## 16. Migration Plan

- Phase 1: Detect (completed).
- Phase 2: Hard fail (current).

## 17. Validation & Test Strategy

- Lint rule test with fixture failing intentionally.

## 18. Adoption Checklist

- [x] Normative statement
- [x] Examples
- [x] Lint rule enforced

## 19. Change Log

| Version | Date | Author | Change |
| ------- | ---- | ------ | ------ |
| 1.0.0 | 2025-09-02 | Eng | Initial version |

---
